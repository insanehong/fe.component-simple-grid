/*!simple-grid v1.0.0b | NHN Entertainment*/
!function(){ne=window.ne||{},ne.component=ne.component||{};var a=0,b=ne.util.defineClass({init:function(a){a&&a.grid&&this.setOwnProperties({grid:a.grid})},getUniqueKey:function(){return++a},setOwnProperties:function(a){return ne.util.forEach(a,function(a,b){this[b]=a},this),this},error:function(a){var b=function(){this.message=a};return b.prototype=new Error,new b}});ne.util.CustomEvents.mixin(b),b.View=ne.util.defineClass(b,{tagName:"div",className:"",eventHandler:{},style:"",init:function(a){b.prototype.init.apply(this,arguments);var c={},d=a&&a.$el||$("<"+this.tagName+">");d.addClass(this.className),ne.util.forEach(this.eventHandler,function(a,b){c[b]=$.proxy(this[a],this)},this),this._attachHandler(d),a&&a.model&&this.setOwnProperties({model:a.model}),this.setOwnProperties({_viewList:[],_eventHandler:c,$el:d,el:d[0]}),this._initializeStyle()},_initializeStyle:function(){this.style&&this.$el.attr("style",this.style)},_dispatchHandler:function(a,b){a=a||this.$el,a.length&&ne.util.forEach(this._eventHandler,function(c,d){var e=d.split(" "),f=e[0],g=e[1]||"";g&&(a=a.find(g)),a.off(f),b&&a.on(f,c)},this)},_attachHandler:function(a){this._dispatchHandler(a,!0)},_detachHandler:function(a){this._dispatchHandler(a)},createView:function(a,b){var c=new a(b);return this.hasOwnProperty("_viewList")||this.setOwnProperties({_viewList:[]}),this._viewList.push(c),c},destroyChildren:function(){if(ne.util.isArray(this._viewList))for(;0!==this._viewList.length;)this._viewList.pop().destroy()},destroy:function(){this.destroyChildren(),this._detachHandler(this.$el),this.$el.empty().remove()}});var c={template:function(a,b){a.replace(/<%=[^%]+%>/g,"");var c=a.replace(/<%=([^%]+)%>/g,function(a,c){return ne.util.isUndefined(b[c])?"":b[c].toString()});return c},getHeight:function(a,b,c){return c=ne.util.isUndefined(c)?1:c,0===a?a:a*(b+c)+c},getDisplayRowCount:function(a,b){return Math.ceil((a-1)/(b+1))},getRowHeight:function(a,b){return 0===a?0:Math.floor((b-1)/a)-1},stripTags:function(a){var b;return a=a.replace(/[\n\r\t]/g,""),ne.util.hasEncodableString(a)&&(/<img/i.test(a)?(b=a.match(/<img[^>]*\ssrc=[\"']?([^>\"']+)[\"']?[^>]*>/i),a=b?b[1]:""):a=a.replace(/<button.*?<\/button>/gi,""),a=$.trim(ne.util.decodeHTMLEntity(a.replace(/<\/?(?:h[1-5]|[a-z]+(?:\:[a-z]+)?)[^>]*>/gi,"")))),a},isMacOs:function(){return navigator.userAgent.indexOf("Macintosh")>0}},d=ne.util.defineClass(b,{init:function(){b.prototype.init.apply(this,arguments),this.setOwnProperties({maxLength:0,list:[],map:{},length:0,idx:0,worker:new e}),this.on("change",this._onChange,this)},lock:function(){this.worker.lock()},unlock:function(){this.worker.unlock()},_onChange:function(){this.length=this.list.length},set:function(){this.worker.enqueue(this._set,arguments,this)},_set:function(a){this.list=this._getFormattedList(a),this.maxLength>0&&this.list.length>this.maxLength&&(this._removeMap(0,this.list.length-this.maxLength),this.list=this.list.slice(this.list.length-this.maxLength,this.list.length)),this.invoke("change",{type:"set",list:a})},_removeMap:function(a,b){var c,d;for(c=a;b>c;c++)d=this.list[c].id,this.map[d]=void 0,delete this.map[d]},_getFormattedList:function(a){var b,c,d=this.grid.option("idAttribute"),e=[],f=!!d;return ne.util.forEachArray(a,function(a){c=f?a[d]:this.idx++,b={id:c,data:a},e.push(b),this.map[b.id]=b},this),e},at:function(a){return this.list[a]},get:function(a){return this.map[a]},indexOf:function(a){var b=-1;return a&&void 0!==a.id?(ne.util.forEachArray(this.list,function(c,d){return c&&c.id.toString()===a.id.toString()?(b=d,!1):void 0},this),b):-1},append:function(){this.worker.enqueue(this._append,arguments,this)},_append:function(a){a=this._getFormattedList(a),this.list=this.list.concat(a),this.maxLength>0&&this.list.length>this.maxLength&&(this._removeMap(0,this.list.length-this.maxLength),this.list=this.list.slice(this.list.length-this.maxLength,this.list.length)),this.invoke("change",{type:"append",list:this.list,appended:a})},prepend:function(){this.worker.enqueue(this._prepend,arguments,this)},_prepend:function(a){a=this._getFormattedList(a),this.list=a.concat(this.list),this.maxLength>0&&this.list.length>this.maxLength&&(this._removeMap(this.maxLength,this.list.length),this.list=this.list.slice(0,this.maxLength)),this.invoke("change",{type:"prepend",list:this.list,prepended:a})},remove:function(){this.worker.enqueue(this._remove,arguments,this)},_remove:function(a){var b=ne.util.isArray(a)?a:[a];ne.util.forEachArray(b,function(a){var b=this.indexOf(this.get(a));this.map[a]=void 0,delete this.map[a],this.list.splice(b,1)},this),this.invoke("change",{type:"remove",list:this.list})},clear:function(){this.worker.enqueue(this._clear,arguments,this)},_clear:function(){this.list=[],this.map={},this.invoke("change",{type:"clear",list:this.list,idx:0})}}),e=ne.util.defineClass(b,{init:function(){b.prototype.init.apply(this,arguments),this.setOwnProperties({locked:!1,queue:[]})},lock:function(){this.locked=!0},unlock:function(a){a||this.runQueue(),this.locked=!1},enqueue:function(a,b,c){this.locked?this.queue.push({job:a,args:b,context:c}):a.apply(c,b)},dequeue:function(){return this.queue.shift()},runQueue:function(){for(var a=this.dequeue();a;)a.job.apply(a.context,a.args),a=this.dequeue()}}),f=ne.util.defineClass(b,{init:function(a){b.prototype.init.apply(this,arguments),this.setOwnProperties({selectMap:{},isMultiple:a&&a.isMultiple||!1})},getSelectList:function(){return ne.util.keys(this.selectMap)},select:function(a){this.isMultiple||ne.util.forEach(this.selectMap,function(a,b){this.unselect(b)},this),this.selectMap[a]=!0,this.fire("select",a,this.selectMap)},unselect:function(a){ne.util.isUndefined(a)?ne.util.forEach(this.selectMap,function(a,b){this.unselect(b)},this):(this.selectMap[a]=null,delete this.selectMap[a],this.fire("unselect",a,this.selectMap))}}),g=ne.util.defineClass(b,{init:function(){b.prototype.init.apply(this,arguments),this._initializeVariables(),this._setHeight(),this.collection.on({change:this._onCollectionChange},this),this.on({change:this._onChange},this),this._calculateColumnWidthList()},_initializeVariables:function(){this.setOwnProperties({collection:new d({grid:this.grid}),offsetTop:0,offsetLeft:0,width:0,height:0,minimumColumnWidth:this.grid.option("minimumColumnWidth"),headerHeight:this.grid.option("headerHeight"),containerHeight:0,containerWidth:0,stopChangeEvent:!1,freeze:!1,rowHeight:this.grid.option("rowHeight")||0,scrollTop:0,scrollLeft:0,maxScrollTop:0,startIdx:0,endIdx:0,top:0,list:[],hiddenLineCount:10,criticalPoint:3})},_resetVariables:function(){this.set({stopChangeEvent:!1,freeze:!1,headerHeight:this.grid.option("headerHeight"),rowHeight:this.grid.option("rowHeight")||0,scrollTop:0,scrollLeft:0,maxScrollTop:0,startIdx:0,endIdx:0,top:0,list:[]})},_onCollectionChange:function(a){var b=a.type;switch(this.stopChangeEvent=!0,b){case"clear":this._resetVariables(),this._refresh();break;case"prepend":this._doFreeze(a.prepended),this._refresh();break;case"set":this._refresh();break;case"append":this._refresh();break;case"remove":this._refresh()}this.stopChangeEvent=!1,this._fireChangeEvents({top:this.top,list:this.list,scrollTop:this.scrollTop})},_fireChangeEvents:function(a){ne.util.forEach(a,function(a,b){this.invoke("change",{key:b,value:a})},this)},_onChange:function(a){var b=a.key,c=a.value;switch(b){case"scrollTop":this._onScrollTopChange(c);break;case"scrollLeft":this._onScrollLeftChange(c);break;case"rowHeight":this.collection.maxLength=this._getMaxCollectionLength();break;case"containerHeight":this.collection.maxLength=this._getMaxCollectionLength();break;case"containerWidth":this._calculateColumnWidthList()}},_onScrollLeftChange:function(a){0>a&&this.set("scrollLeft",0)},_onScrollTopChange:function(a){this.maxScrollTop<a?this.set("scrollTop",this.maxScrollTop,{silent:!0}):0>a?this.set("scrollTop",0,{silent:!0}):this._isRenderable()&&this._refresh()},_getMaxCollectionLength:function(){var a=+this.grid.option("border")||0;return ne.util.browser.msie?Math.floor(this.grid.ieMaxHeight/(this.rowHeight+a)):0},getMaxScrollTop:function(){var a=this.grid.option("border"),b=c.getHeight(this.collection.length,this.rowHeight,a)-this.containerHeight;return this.grid.option("scrollX")&&(b+=this.grid.scrollBarSize),Math.max(b,0)},set:function(a,b,c){ne.util.isObject(a)?ne.util.forEach(a,function(a,c){this.set(c,a,b)},this):this[a]!=b&&(this[a]=b,c&&c.silent||this.stopChangeEvent||this.invoke("change",{key:a,value:b}))},_setHeight:function(){var a;ne.util.isExisty(this.grid.option("height"))?(a=this.grid.option("height"),this.grid.option("scrollX")&&(a-=this.grid.scrollBarSize)):a=c.getHeight(this.grid.option("displayCount"),this.grid.option("rowHeight"),this.grid.option("border")),this.set("height",a)},_refresh:function(){var a=this._getRenderingData(),b=this.collection.list.slice(a.startIdx,a.endIdx);this.set({startIdx:a.startIdx,endIdx:a.endIdx,list:b,top:a.top}),this.invoke("refresh")},setColumnWidth:function(a,b){b=Math.max(b,this.minimumColumnWidth);var c=ne.util.extend([],this.columnWidthList);ne.util.isUndefined(c[a])||(c[a]=b,this._calculateColumnWidthList(c))},_calculateColumnWidthList:function(a){a=a||[];var b,c,d=this.grid.option("columnModelList"),e=(this.grid.option("defaultColumnWidth"),this.grid.option("minimumColumnWidth")),f=this.grid.option("border"),g=this.containerWidth-this.grid.scrollBarSize,h=0,i=0;a.length||ne.util.forEachArray(d,function(b){var c=ne.util.isUndefined(b.width)?-1:Math.max(e,b.width);ne.util.isString(c)&&c.indexOf("%")&&(c=c.replace("%",""),c=Math.floor(g*(c/100))),a.push(c)},this),ne.util.forEachArray(a,function(a){a>0?(a=Math.max(e,a),h+=a+f):i++},this),h+=f,c=g-h,b=Math.max(e,Math.floor(c/i)-f),ne.util.forEachArray(a,function(c,d){-1===c&&(a[d]=b,h+=b+f)}),c=g-h,0>c&&(g+=Math.abs(c)),this.set({width:g,columnWidthList:a})},_getDataHeight:function(a){var b=this.grid.option("border");return c.getHeight(a.length,this.rowHeight,b)},_doFreeze:function(a){if(this.freeze||this.grid.option("freeze")&&0!==this.scrollTop){var b=this._getDataHeight(a);this.set("maxScrollTop",this.getMaxScrollTop()),this.set("scrollTop",this.scrollTop+b)}},_getRenderingData:function(){var a,b=this.grid.option("border"),d=this.scrollTop,e=this.rowHeight,f=this.grid.option("displayCount"),g=Math.max(0,Math.ceil(d/(e+b))-this.hiddenLineCount),h=Math.min(this.collection.length,Math.floor(g+this.hiddenLineCount+f+this.hiddenLineCount));return a=0===g?0:c.getHeight(g,e,b)-b,{top:a,startIdx:g,endIdx:h}},_isRenderable:function(){var a=this.grid.option("border"),b=this.scrollTop,c=this.rowHeight,d=this.height,e=(this.grid.option("displayCount"),this.collection.length),f=Math.max(0,Math.ceil(b/(c+a))),g=Math.min(e-1,Math.floor((b+d)/(c+a))),h=Math.max(0,this.startIdx),i=Math.min(e,this.endIdx);return 0!==h&&h+this.criticalPoint>f?!0:i!==e&&i-this.criticalPoint<g?!0:!1}}),h=ne.util.defineClass(b.View,{eventHandler:{mousedown:"_onMouseDown",click:"_onClick"},padding:10,className:"infinite_body",style:"position: absolute; top: 0; white-space: nowrap;",_template:{table:'<table width="100%" border="0" cellpadding="0" cellspacing="<%=border%>" bgcolor="<%=color%>" class="<%=className%>" style="table-layout:fixed"><colgroup><%=col%></colgroup><tbody><%=tbody%></tbody>',tr:'<tr key="<%=key%>" style="height:<%=height%>px;background:<%=color%>;" class="<%=className%>" ><%=content%></tr>',td:'<td columnname="<%=columnName%>" style="text-align:<%=align%>;overflow:hidden;padding:0 <%=padding%>px;*padding:0 <%=padding%>px;border:0;white-space:nowrap;*white-space:pre;" class="<%=className%>" <%=attributes%>><%=content%></td>'},init:function(a){b.View.prototype.init.apply(this,arguments),this.grid.option("useSelection")&&this.setOwnProperties({selection:a.selection}),this.setOwnProperties({resizeHandler:null,isIe7:!(!ne.util.browser.msie||7!==ne.util.browser.version)}),this.grid.focusModel.on("select",this.select,this),this.grid.focusModel.on("unselect",this.unselect,this),this.model.on({change:this._onModelChange,refresh:this._onRefresh},this),this.grid.view.container.on({scroll:this._onScroll},this)},select:function(a){var b=this.$el.find('tr[key="'+a+'"]');b.length&&b.css("background","").addClass("selected")},unselect:function(a){var b=this.$el.find('tr[key="'+a+'"]'),c=this.grid.option("color");b.length&&b.removeClass("selected").css("background",c.td)},_onScroll:function(){this.selection&&this.selection.draw()},_onClick:function(a){var b=$(a.target),c=b.closest("td").attr("columnname"),d=b.closest("tr").attr("key"),e={$target:b,rowKey:d,columnName:c};this.fire("click",e)},_onMouseDown:function(a){var b=$(a.target),c=b.closest("tr").attr("key"),d=this.selection;this.grid.focusModel.select(c),d&&(d.attachMouseEvent(a),a.shiftKey?(d.hasSelection()||d.startSelection(),d.updateSelection()):d.stopSelection())},_onModelChange:function(a){var b=a.key,c=a.value;"top"===b?this.$el.css("top",c+"px"):"width"===b?this._setContainerWidth(c):"columnWidthList"===b&&this._changeColumnWidth(c)},_changeColumnWidth:function(a){var b=this.$el.find("colgroup").find("col");ne.util.forEachArray(a,function(a,c){this.isIe7&&(a-=2*this.padding),b.eq(c).css("width",a+"px")},this)},_onRefresh:function(){this.render()},_getColGroupMarkup:function(a){var b="";return ne.util.forEachArray(a,function(a){this.isIe7&&(a-=2*this.padding),b+='<col style="width:'+a+'px"></col>'},this),b},_getTbodyMarkup:function(){var a=this.model.list,b=this.grid.option("columnModelList"),d=this.grid.option("color"),e=[],f=this.grid.option("className");return ne.util.forEachArray(a,function(a){var g=[],h=this.model.rowHeight,i=a.data._colSpanBy,j=b.length,k=ne.util.isExisty(i)?'colspan="'+j+'"':"";ne.util.forEachArray(b,function(b){var d,e,h=b.columnName;ne.util.isExisty(i)&&i!==h||(e=ne.util.isFunction(b.formatter)?b.formatter(a.data[h],a.data):a.data[h],d=c.template(this._template.td,{className:f.td,columnName:h,align:b.align,padding:this.padding,content:e,attributes:k}),g.push(d))},this),e.push(c.template(this._template.tr,{className:f.tr,color:d.td,height:h,key:a.id,content:g.join("")}))},this),e.join("")},render:function(){this._detachHandler(),this.destroyChildren();var a=this.model.columnWidthList,b=this.grid.option("color"),d=this.grid.option("border"),e=this.grid.focusModel.getSelectList(),f=this.grid.option("className");return this.$el.empty().prepend(c.template(this._template.table,{className:f.table,border:d,color:d?b.border:"",col:this._getColGroupMarkup(a),tbody:this._getTbodyMarkup()})),this._setContainerWidth(Math.ceil(this.model.width)),ne.util.forEachArray(e,function(a){this.select(a)},this),this.selection&&this.selection.draw(),this.grid.option("useColumnResize")&&(this.resizeHandler=this.createView(l,{grid:this.grid,model:this.model,height:this.$el.height()}),this.$el.append(this.resizeHandler.render().el)),this._attachHandler(),this},_setContainerWidth:function(a){0===a?a="100%":a+="px",this.$el.css("width",a)}}),i=ne.util.defineClass(b.View,{className:"infinite_container",eventHandler:{scroll:"_onScroll"},style:"position: relative;",init:function(){b.View.prototype.init.apply(this,arguments),this.model.on({change:this._onModelChange},this),this._initializeCss()},_initializeCss:function(){var a=this.grid.option("color").border,b=this.grid.option("border");this.$el.css({"overflow-x":this.grid.option("scrollX")?"scroll":"hidden","overflow-y":this.grid.option("scrollY")?"scroll":"hidden",height:this.grid.option("scrollX")?this.model.height+this.grid.scrollBarSize:this.model.height}),0===b&&this.$el.css("border","solid 1px "+a)},_onScroll:function(a){var b=Math.abs(this.model.scrollTop-a.target.scrollTop);10>b&&b>0&&(this.model.scrollTop>a.target.scrollTop?a.target.scrollTop-=80:a.target.scrollTop+=80),this.model.set({scrollTop:a.target.scrollTop,scrollLeft:a.target.scrollLeft}),this.invoke("scroll",a)},_onModelChange:function(a){var b=a.key,c=a.value;"scrollTop"===b?this.el.scrollTop=c:"scrollLeft"===b&&(this.el.scrollLeft=c,this.el.scrollLeft!==c&&this.model.set("scrollLeft",this.el.scrollLeft))},render:function(){return this._detachHandler(),this.destroyChildren(),this.selection=this.createView(n,{grid:this.grid,model:this.model}),this.body=this.createView(h,{grid:this.grid,selection:this.selection,model:this.model}),this.$el.empty().append(this.body.render().el).append(this.selection.render().el),this._attachHandler(),this}}),j=ne.util.defineClass(b.View,{className:"infinite_header_container",style:"overflow:hidden;position: relative;",init:function(){b.View.prototype.init.apply(this,arguments),this.model.on("change",this._onModelChange,this),this.setOwnProperties({resizeHandler:null})},_template:{table:'<div class="infinite_header"><table width="100%" border="0" cellpadding="0" cellspacing="<%=border%>" style="table-layout:fixed;"><colgroup><%=col%></colgroup><tbody><%=tbody%></tbody></div>'},_onModelChange:function(a){var b=a.key,c=a.value;"width"===b?this._setContainerWidth(c):"scrollLeft"===b?this.$el[0].scrollLeft=c:"columnWidthList"===b&&this._changeColumnWidth(c)},_changeColumnWidth:function(a){var b=this.$el.find("colgroup").find("col");ne.util.forEachArray(a,function(a,c){b.eq(c).width(a)},this)},render:function(){this._detachHandler(),this.destroyChildren();var a,b=this.grid.option("columnModelList"),d=this.grid.option("border"),e="",f=this.model.headerHeight,g="",h=this.grid.option("color");return ne.util.forEachArray(b,function(){g+="<col></col>"},this),e+='<tr style="height:'+f+'px">',ne.util.forEachArray(b,function(a){e+='<th columnname="'+a.columnName+'" style="overflow:hidden;white-space:nowrap;*white-space:pre;text-align:center;padding:0;border:0;">'+a.title+"</th>"}),e+="</tr>",a=c.template(this._template.table,{border:d,col:g,tbody:e}),this.$el.html(a),this._setContainerWidth(this.model.width),this.$el.find("table").css("background",h.border),this.$el.find("th").css("background",h.th),0===d&&(this.$el.css("border","solid 1px "+h.border),this.$el.css("border-bottom","0px")),this.grid.option("useColumnResize")&&(this.resizeHandler=this.createView(l,{grid:this.grid,model:this.model,height:f}),this.$el.append(this.resizeHandler.render().el)),this.grid.option("hasHeader")||this.$el.css({height:"0px",width:"0px",border:0}),this._attachHandler(),this},_setContainerWidth:function(a){var b=6*this.grid.option("border")+this.grid.scrollBarSize;0===a?a="100%":a+="px",this.$el.find(".infinite_header:first").css({width:a,paddingRight:b+"px"})}}),k=ne.util.defineClass(b.View,{keyMap:{PAGE_UP:33,PAGE_DOWN:34,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,HOME:36,END:35,CHAR_A:65,CHAR_C:67,CTRL:17,META:91,SHIFT:16},eventHandler:{keydown:"_onKeyDown",keyup:"_onKeyUp",blur:"_onBlur",focus:"_onFocus"},tagName:"textarea",style:"position: absolute; width: 0; height: 0; top:0; left: -9999px;",init:function(){b.View.prototype.init.apply(this,arguments)},_onFocus:function(){this.grid.getSelectionInstance().show()},_onBlur:function(){this.model.collection.unlock(),this.grid.blur()},_onKeyUp:function(){this.model.collection.unlock()},_onKeyDown:function(a){var b=!0,c=a.which?a.which:a.keyCode;switch(this.model.collection.lock(),c){case this.keyMap.SHIFT:break;case this.keyMap.CTRL:break;case this.keyMap.META:break;case this.keyMap.UP_ARROW:this.scrollVertical(-this.grid.scrollingScale);break;case this.keyMap.DOWN_ARROW:this.scrollVertical(this.grid.scrollingScale);break;case this.keyMap.LEFT_ARROW:this.scrollHorizontal(-this.grid.scrollingScale);break;case this.keyMap.RIGHT_ARROW:this.scrollHorizontal(this.grid.scrollingScale);break;case this.keyMap.PAGE_UP:this.scrollVertical(-this.grid.scrollingScalePerPage,!0);break;case this.keyMap.PAGE_DOWN:this.scrollVertical(this.grid.scrollingScalePerPage,!0);break;case this.keyMap.HOME:this.model.set("scrollTop",0);break;case this.keyMap.END:this.model.set("scrollTop",this.model.maxScrollTop);break;case this.keyMap.CHAR_A:(a.ctrlKey||a.metaKey)&&(a.preventDefault(),this.grid.getSelectionInstance().selectAll());break;case this.keyMap.CHAR_C:(a.ctrlKey||a.metaKey)&&this._keyDownForCopy();break;default:b=!1}b&&!this.grid.option("keyEventBubble")&&a.stopPropagation()},_keyDownForCopy:function(){var a=this.grid.getSelectionInstance().getSelectionData().join("\n");window.clipboardData?window.clipboardData.setData("Text",a)?this.$el.select():this.$el.val("").select():this.$el.val(a).select()},scrollVertical:function(a,b){a=b?Math.floor(this.model.height*(a/100)):a;var c=Math.max(0,this.model.scrollTop+a);this.model.set("scrollTop",c)},scrollHorizontal:function(a){var b=Math.max(0,this.model.scrollLeft+a);this.model.set("scrollLeft",b)},render:function(){return this._detachHandler(),this._attachHandler(),this}}),l=ne.util.defineClass(b.View,{className:"infinite_resize_handler_container",eventHandler:{"mousedown .infinite_resize_handler":"_onMouseDown"},style:"position:relative;width:0px;",init:function(a){b.View.prototype.init.apply(this,arguments),this.setOwnProperties({height:a.height,isResizing:!1,$target:null,differenceLeft:0,initialWidth:0,initialOffsetLeft:0,initialLeft:0,useSelectionStatus:null}),this.height=a.height,this.model.on("change",this._onModelChange,this)},_onModelChange:function(a){var b=a.key;"columnWidthList"===b&&this._refreshHandlerPosition()},render:function(){var a,b=this.grid.option("columnModelList"),c=b.length;return this._detachHandler(),this.destroyChildren(),this.$el.empty(),ne.util.forEachArray(b,function(b,d){a=this.createView(m,{grid:this.grid,index:d,columnName:b.columnName,isLast:d===c-1}),this.$el.append(a.render().el)},this),this.$el.css({height:this.height+"px",marginTop:-this.height+"px"}),this._attachHandler(),this._refreshHandlerPosition(),this},_refreshHandlerPosition:function(){var a,b,c=this.model.columnWidthList,d=this.$el.find(".infinite_resize_handler"),e=this.grid.option("border"),f=this.grid.view.header.$el.find("th"),g=0;ne.util.forEachArray(d,function(h,i){a=f.eq(i).width()||c[i],b=d.eq(i),g+=a+e,b.css("left",g-4+"px")},this)},_onMouseDown:function(a){this.useSelectionStatus=this.grid.option("useSelection"),this.grid.option("useSelection",!1),this._startResizing(a)},_onMouseUp:function(){this.grid.option("useSelection",this.useSelectionStatus),this._stopResizing()},_onMouseMove:function(a){if(this._isResizing()){a.preventDefault();var b=a.pageX-this.initialOffsetLeft,c=this._calculateWidth(a.pageX),d=parseInt(this.$target.attr("columnindex"),10);this.$target.css("left",b+"px"),this.model.setColumnWidth(d,c)}},_calculateWidth:function(a){var b=a-this.initialOffsetLeft-this.initialLeft;return this.initialWidth+b},_isResizing:function(){return!!this.isResizing},_startResizing:function(a){var b=this.model.columnWidthList,c=$(a.target);this.isResizing=!0,this.$target=c,this.initialLeft=parseInt(c.css("left").replace("px",""),10),this.initialOffsetLeft=this.$el.offset().left,this.initialWidth=b[c.attr("columnindex")],$("body").bind("mousemove",$.proxy(this._onMouseMove,this)).bind("mouseup",$.proxy(this._onMouseUp,this)).css("cursor","col-resize")},_stopResizing:function(){this.isResizing=!1,this.$target=null,this.initialLeft=0,this.initialOffsetLeft=0,this.initialWidth=0,$("body").unbind("mousemove",$.proxy(this._onMouseMove,this)).unbind("mouseup",$.proxy(this._onMouseUp,this)).css("cursor","default")}}),m=ne.util.defineClass(b.View,{className:"infinite_resize_handler",style:"float:left; position:absolute; height:100%; opacity:0; filter:alpha(opacity=0); cursor:col-resize;",handlerWidth:7,init:function(a){b.View.prototype.init.apply(this,arguments),this.setOwnProperties({columnName:a.columnName,index:a.index,isLast:a.isLast})},render:function(){var a=this.grid.option("color").border;return this._detachHandler(),this.destroyChildren(),this.$el.empty(),this.$el.attr({columnindex:this.index,columnname:this.columnName,title:"마우스 드래그를 통해 컬럼의 넓이를 변경할 수 있습니다."}).css({background:a}),this.$el.width(this.isLast?Math.floor(this.handlerWidth/2):this.handlerWidth),this._attachHandler(),this}}),n=ne.util.defineClass(b.View,{eventHandler:{mousedown:"_onMouseDown"},className:"infinite_selection_layer",style:"display:none;position:absolute;top:0;left:1px;width:0;height:0;border:dotted 1px red;background:orange;opacity:0.2;filter:alpha(opacity=10)",init:function(){b.View.prototype.init.apply(this,arguments),this.grid.view.keyboard.on({blur:this.stopSelection},this),this.model.on({change:this._onModelChange},this),this.setOwnProperties({rangeKey:[-1,-1],isShown:!1}),this.setOwnProperties({selectionHandler:{mousemove:$.proxy(this._onMouseMove,this),mouseup:$.proxy(this._onMouseUp,this),selectstart:$.proxy(this._onSelectStart,this)},timeoutForUpdateSelection:0,startPageX:0,startPageY:0,mousePos:{pageX:0,pageY:0}})},attachMouseEvent:function(a){this.grid.option("useSelection")&&(this.setOwnProperties({startPageX:a.pageX,startPageY:a.pageY}),this._setMousePos(a),$(document).on("mousemove",this.selectionHandler.mousemove),$(document).on("mouseup",this.selectionHandler.mouseup),$(document).on("selectstart",this.selectionHandler.selectstart))},detachMouseEvent:function(){$(document).off("mousemove",this.selectionHandler.mousemove),$(document).off("mouseup",this.selectionHandler.mouseup),$(document).off("selectstart",this.selectionHandler.selectstart)},_onMouseDown:function(a){var b=a.pageX,c=a.pageY,d=this.getKey(b,c);this.attachMouseEvent(a),this.grid.focusModel.select(d),a.shiftKey?(this.hasSelection()||this.startSelection(d),this.updateSelection(d)):this.stopSelection()},_onMouseMove:function(a){this._setMousePos(a),this.hasSelection()?(clearTimeout(this.timeoutForUpdateSelection),this.timeoutForUpdateSelection=setTimeout($.proxy(this._scrollOnSelection,this),0),this.updateSelection()):this._getDistance(a)>10&&this.startSelection(this.getKey(this.startPageX,this.startPageY))},_onMouseUp:function(){this.detachMouseEvent()},_onSelectStart:function(a){return a.preventDefault(),!1},_scrollOnSelection:function(){if(this.hasSelection()){var a=this.overflowStatus(this.mousePos.pageX,this.mousePos.pageY);a.y>0?this.model.set("scrollTop",this.model.scrollTop+this.grid.scrollingScale):a.y<0&&this.model.set("scrollTop",this.model.scrollTop-this.grid.scrollingScale),a.x>0?this.model.set("scrollLeft",this.model.scrollLeft+this.grid.scrollingScale):a.x<0&&this.model.set("scrollLeft",this.model.scrollLeft-this.grid.scrollingScale)}},_getDistance:function(a){var b=a.pageX,c=a.pageY,d=Math.abs(this.startPageX-b),e=Math.abs(this.startPageY-c);return Math.round(Math.sqrt(Math.pow(d,2)+Math.pow(e,2)))},_setMousePos:function(a){this.mousePos.pageX=a.pageX,this.mousePos.pageY=a.pageY},_onModelChange:function(a){var b=a.key,c=a.value;"headerHeight"===b||"top"===b?this.draw():"width"===b&&this.$el.width(c-3)},getSelectionRange:function(){return this.rangeKey},getSelectionRangeIndex:function(){var a=this.model.collection,b=[a.indexOf(a.get(this.rangeKey[0])),a.indexOf(a.get(this.rangeKey[1]))],c=Math.min.apply(Math,b),d=Math.max.apply(Math,b);return[c,d]},hasSelection:function(){return!(-1===this.rangeKey[0])},getSelectionLength:function(){var a=this.getSelectionRangeIndex();return a[1]+1-a[0]},startSelection:function(a){this.grid.option("useSelection")&&(a=ne.util.isUndefined(a)?this.getKey(this.mousePos.pageX,this.mousePos.pageY):a,-1!==a&&(this.rangeKey[0]=a,this.updateSelection(a)))},updateSelection:function(a){this.grid.option("useSelection")&&(a=ne.util.isUndefined(a)?this.getKey(this.mousePos.pageX,this.mousePos.pageY):a,-1!==a&&(this.rangeKey[1]=a,this.show()))},getSelectionData:function(){var a=this.getSelectionRangeIndex(),b=this.model.collection.list.slice(a[0],a[1]+1),d=this.grid.option("columnModelList"),e=[];return ne.util.forEachArray(b,function(a){var b=[];ne.util.forEachArray(d,function(d){var e,f=d.columnName,g=a.data;e=ne.util.isFunction(d.formatter)?d.formatter(g[f],g):g[f],b.push(c.stripTags(e))}),e.push(b.join("	"))}),e},selectAll:function(){var a=this.model.collection;this.rangeKey=[a.at(0).id,a.at(a.length-1).id],this.draw()},stopSelection:function(){this.rangeKey=[-1,-1],this.draw()},show:function(){this.isShown=!0,this.draw()},hide:function(){this.isShown=!1,this.draw()},overflowStatus:function(a,b){var c=b-this.model.offsetTop-this.model.headerHeight,d=a-this.model.offsetLeft,e={x:0,y:0};return c>this.model.height+this.model.headerHeight?e.y=1:0>c&&(e.y=-1),d>this.model.containerWidth?e.x=1:0>d&&(e.x=-1),e},getKey:function(a,b){var c,d=this.model,e=d.scrollTop,f=d.rowHeight,g=d.offsetTop,h=d.height,i=this.grid.option("border"),j=d.headerHeight,k=b-g-j,l=e+k,m=this.overflowStatus(a,b);return m.y>0?l=e+h-1:m.y<0&&(l=e+1),c=Math.min(Math.max(0,Math.floor(l/(f+i))),d.collection.length-1),d.collection.at(c)&&d.collection.at(c).id},draw:function(){if(this.isShown&&-1!==this.rangeKey[0]&&-1!==this.rangeKey[1]){var a,b,d,e=this.model.collection,f=this.grid.option("border"),g=e.indexOf(e.get(this.rangeKey[0])),h=e.indexOf(e.get(this.rangeKey[1])),i=(e.length,Math.min(g,h)),j=Math.max(g,h),k=c.getHeight(i,this.model.rowHeight,f)-f,l=c.getHeight(j-i+1,this.model.rowHeight,f),m=this.model.width-3,n="block";a=Math.max(this.model.scrollTop-10,k)-1,b=a-k,d=Math.min(this.model.height+10,l-b)-2,0>=d&&(n="none"),this.$el.css({width:m+"px",top:a+"px",height:d+"px",display:n})}else this.$el.css({display:"none"}),this.isShown&&this.grid.view.keyboard.$el.val("")},render:function(){var a=this.grid.option("color"),b=this.grid.option("opacity");return this._detachHandler(),this.$el.css({width:"100%",background:a.selection,opacity:b}),this.draw(),this._attachHandler(),this},destroy:function(){this.detachMouseEvent(),this.destroyChildren(),this._detachHandler(this.$el),this.$el.empty().remove()}}),o=ne.util.defineClass(b.View,{eventHandler:{},className:"infinite_spacer",style:"display: block;	position: absolute;	top: 0;	right: 0; width: 16px;",init:function(){b.View.prototype.init.apply(this,arguments)},render:function(){var a=this.grid,b=a.option("color"),c=a.option("headerHeight"),d=a.option("border"),e=d?0:1,f=d?0:1,g=17-d,h={top:e+"px",right:f+"px",background:b.th,height:c+"px",width:g+"px",border:"solid "+d+"px "+b.border};return this._detachHandler(),this.destroyChildren(),this.$el.css(h),this._attachHandler(),this}}),p=ne.util.defineClass(b.View,{className:"infinite_virtial_scrollbar",eventHandler:{scroll:"_onScroll"},style:"overflow-y: scroll; overflow-x: hidden; position: absolute; top: 0; right: 0; display: block;",init:function(){b.View.prototype.init.apply(this,arguments),this.model.on({change:this._onModelChange},this),this.setOwnProperties({timeoutIdForLock:0,isScrollHandlerFocused:!1})},_onMouseDown:function(){this.model.collection.lock(),this.grid.updateLayoutData(),this.isScrollHandlerFocused=!0,this._updateUnlockTimeout()},_updateUnlockTimeout:function(){this.isScrollHandlerFocused&&(clearTimeout(this.timeoutIdForLock),this.model.collection.lock(),this.timeoutIdForLock=setTimeout($.proxy(function(){this.isScrollHandlerFocused=!1,this.model.collection.unlock()},this),1e3))},_onScroll:function(a){this.model.set("scrollTop",$(a.target).scrollTop()),this._updateUnlockTimeout(),this.isScrollHandlerFocused=!0},_onModelChange:function(a){var b=a.key,c=a.value;"scrollTop"===b?(this.isScrollHandlerFocused=!1,this._onScrollTopChange(c)):"headerHeight"===b?this.$el.css("top",c+"px"):this._setContentHeight()},_onScrollTopChange:function(a){this.el.scrollTop=a},_getMaxScrollTop:function(){return this.$el.find(".infinite_content").height()-this.$el.innerHeight()},render:function(){this._detachHandler();var a,b=this.grid.scrollBarSize+1,c=0===this.grid.option("border")?1:0,d=this.createView(p.Content,{grid:this.grid}),e=this.grid.option("border");return a=this.grid.option("hasHeader")?this.grid.option("headerHeight")+(2*e||2):1,this.$el.css({height:this.model.height,top:a,right:c,width:b+"px"}),this.$el.empty(),this.$el.html(d.render().el),this._setContentHeight(),this._attachHandler(),this},_setContentHeight:function(){var a,b=this.grid.option("border"),d=this.grid.option("rowHeight"),e=this.model.collection.length,f=c.getHeight(e,d,b);

this.$el.find(".infinite_content").height(f),a=this.model.getMaxScrollTop(),this.model.set("maxScrollTop",a)},_getContentHeight:function(){return this.$el.find(".infinite_content").height()}});p.Content=ne.util.defineClass(b.View,{className:"infinite_content",style:"width: 1px; display: block; background: transparent;",init:function(){b.View.prototype.init.apply(this,arguments)},render:function(){return this}}),ne.component.SimpleGrid=ne.util.defineClass(b.View,{scrollBarSize:17,scrollingScale:40,scrollingScalePerPage:90,ieMaxHeight:1533917,className:"simple_grid",eventHandler:{mouseover:"_onMouseOver",mouseout:"_onMouseOut",mousedown:"_onMouseDown",focus:"_onFocus"},init:function(a){b.View.prototype.init.apply(this,arguments);var c=this.getUniqueKey(),d={rowHeight:20,displayCount:10,headerHeight:30,scrollX:!0,scrollY:!0,freeze:!0,keyEventBubble:!1,idAttribute:null,columnModelList:[],defaultColumnWidth:50,useSelection:!0,useColumnResize:!0,hasHeader:!0,minimumColumnWidth:20,className:{table:"",tr:"",td:""},color:{border:"#EFEFEF",th:"#F8F8F8",td:"#FFFFFF",selection:"orange"},border:1,opacity:"0.2"};return this.__instance[c]=this,a=$.extend(!0,d,a),this.setOwnProperties({id:c,model:null,focusModel:null,view:{header:null,spacer:null,container:null,virtualScroll:null,keyboard:null},options:a,timeoutIdForBlur:0}),this.option("hasHeader")||this.option("headerHeight",0),this._initializeStyleSheet(),this._initializeModel(),this._initializeView(),this.render(),this._initializeCustomEvent(),this},_initializeCustomEvent:function(){this.view.container.body.on("click",function(a){return this.invoke("click",a)},this)},focus:function(){this.view.keyboard.$el.focus().select()},blur:function(){this.view.container.selection.hide()},_initializeModel:function(){this.model=new g({grid:this}),this.focusModel=new f({grid:this})},_initializeView:function(){this.view.header=this.createView(j,{grid:this,model:this.model}),this.view.spacer=this.createView(o,{grid:this,model:this.model}),this.view.container=this.createView(i,{grid:this,model:this.model}),this.view.keyboard=this.createView(k,{grid:this,model:this.model})},_initializeStyleSheet:function(){var a=[];c.isMacOs()&&(a=[".simple_grid {scrollbar-highlight-color:#f2f2f2;scrollbar-shadow-color:#f2f2f2;scrollbar-arrow-color:#8a8a8a;scrollbar-face-color:#d9d9d9;scrollbar-3dlight-color:#f2f2f2;scrollbar-darkshadow-color:#f2f2f2;scrollbar-track-color:#f2f2f2;}",".simple_grid ::-webkit-scrollbar{-webkit-appearance: none;width:17px;height:17px;background-color:#f2f2f2;}",".simple_grid ::-webkit-scrollbar-thumb{background-color:#d9d9d9;border:5px solid transparent;border-radius:7px;background-clip:content-box;}",".simple_grid ::-webkit-scrollbar-thumb:hover{background-color: #c1c1c1;}",".simple_grid ::-webkit-scrollbar-corner{background-color: #f2f2f2;}"]),$("#simple_grid_style").length||$("html > head").append($('<style id="simple_grid_style">\n'+a.join("\n")+"</style>"))},_onMouseDown:function(){$(document).on("mouseup",$.proxy(this._onMouseUp,this)),this.model.collection.lock(),this.updateLayoutData(),clearTimeout(this.timeoutIdForBlur),this.timeoutIdForBlur=setTimeout($.proxy(function(){this.focus()},this),0)},_onMouseUp:function(){this.model.collection.unlock(),$(document).off("mouseup",$.proxy(this._onMouseUp,this))},getSelectionInstance:function(){return this.view.container.selection},setList:function(a){return this.clear(),this.model.collection.set(a),this},remove:function(a){var b=ne.util.isArray(a)?a:[a];return this.model.collection.remove(b),this},append:function(a){return this.model.collection.append(a),this},prepend:function(a){return this.model.collection.prepend(a),this},clear:function(){return this.model.collection.clear(),this},getList:function(){return this.model.collection.list},render:function(){return this.destroyChildren(),this._detachHandler(),this.$el.attr({instanceId:this.id}).css({position:"relative"}),this.$el.empty(),this.$el.append(this.view.header.render().el).append(this.view.spacer.render().el),this.$el.append(this.view.container.render().el).append(this.view.keyboard.render().el),this.option("scrollY")&&(this.view.virtualScroll=this.createView(p,{grid:this,model:this.model}),this.$el.append(this.view.virtualScroll.render().el)),this.updateLayoutData(),this._attachHandler(),this},updateLayoutData:function(){var a=this.$el.offset();this.model.set({offsetTop:a.top,offsetLeft:a.left,containerWidth:this.view.container.$el.width(),containerHeight:this.view.container.$el.height()})},option:function(a,b){return void 0===b?this.options[a]:(this.options[a]=b,this)}}),ne.component.SimpleGrid.prototype.__instance={},ne.component.SimpleGrid.getInstanceById=function(a){return this.__instance[a]}}();
//# sourceMappingURL=simple-grid.min.map