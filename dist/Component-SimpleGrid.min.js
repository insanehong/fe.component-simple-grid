!function(){!function(ne){"use strict";ne||(ne=window.ne={}),ne.util||(ne.util=window.ne.util={});var ajax={};ajax._ajaxRequestData={},ajax.request=function(a,b){var c=a;if(!c)return alert("요청을 보낼 URL을 입력해 주시기 바랍니다."),!1;var d=ajax.util._getRandomId();b=b||{},b._complete=b.complete,b._success=b.success,b._error=b.error,b=$.extend(b,{url:c,data:b.data||{},type:b.type||"post",dataType:b.dataType||"json",complete:$.proxy(this._onAjaxComplete,this,d),success:$.proxy(this._onAjaxSuccess,this,d),error:$.proxy(this._onAjaxError,this,d)});var e,f;for(var g in this._ajaxRequestData)if(e=b.url===this._ajaxRequestData[g].url,f=$.compareJSON(this._ajaxRequestData[g].data,b.data),e&&f)return!1;this._ajaxRequestData[d]=ajax.util.cloningObject(b),$.ajax(b)},ajax._onAjaxComplete=function(a,b,c){var d=this._ajaxRequestData[a];if(!d)throw new Error("Ajax 요청 정보가 없습니다.");d._complete&&$.isFunction(d._complete)&&d._complete(c,b),delete this._ajaxRequestData[a]},ajax._onAjaxSuccess=function(a,b,c,d){var e=this._ajaxRequestData[a];if(!e)throw new Error("Ajax 요청 정보가 없습니다.");var f=!0;e._success&&$.isFunction(e._success)&&(f=e._success(b,c,d)),f!==!1&&b&&b.data&&(b.data.message&&alert(b.data.message),b.data.redirectUrl&&(location.href=b.data.redirectUrl),b.data.closeWindow&&ajax.util.close(!0))},ajax._onAjaxError=function(a,b,c,d){var e=this._ajaxRequestData[a];if(!e)throw new Error("Ajax 요청 정보가 없습니다.");var f=!0;e._error&&$.isFunction(e._error)&&(f=e._error(b,c,d))},ajax.util={},ajax.util.cloningObject=function(sourceTarget){var constructor,destinationTarget,x,y;if("object"==typeof sourceTarget&&(constructor=this.getConstructorName(sourceTarget))){if(destinationTarget=eval("new "+constructor+"()"),sourceTarget.prototype)for(x in sourceTarget.prototype)destinationTarget.prototype[x]=this.cloningObject(sourceTarget.prototype[x]);for(y in sourceTarget)destinationTarget[y]=sourceTarget[y]instanceof RegExp?eval(sourceTarget[y].toString()):this.cloningObject(sourceTarget[y]);return destinationTarget}return destinationTarget=sourceTarget},ajax.util.getConstructorName=function(a){if(a&&a.constructor){var b=a.constructor.toString(),c=b.match(/function ([^\(]*)/);return c&&c[1]||null}return null},ajax.util._getRandomId=function(){return String(parseInt(1e10*Math.random(),10))},ajax.util.close=function(a,b){var c=b||window;ne.util.isTruthy(a)&&$(c).off("beforeunload"),c.closed||(c.opener=window.location.href,c.close())},ne.util.ajax=ajax}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var b,c,d={chrome:!1,firefox:!1,safari:!1,msie:!1,others:!1,version:0},e=window.navigator,f=e.appName.replace(/\s/g,"_"),g=e.userAgent,h=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i=/Trident.*rv\:11\./,j={firefox:/Firefox\/(\d+)\./,chrome:/Chrome\/(\d+)\./,safari:/Version\/([\d\.]+)\sSafari\/(\d+)/},k={Microsoft_Internet_Explorer:function(){d.msie=!0,d.version=parseFloat(g.match(h)[1])},Netscape:function(){var a=!1;if(i.exec(g))d.msie=!0,d.version=11;else for(b in j)if(j.hasOwnProperty(b)&&(c=g.match(j[b]),c&&c.length>1)){d[b]=a=!0,d.version=parseFloat(c[1]||0);break}a||(d.others=!0)}};k[f](),a.util.browser=d}(window.ne),function(a){"use strict";function b(a,b,c){for(var d=0,e=a.length;e>d&&b.call(c||null,a[d],d,a)!==!1;d++);}function c(a,b,c){var d;for(d in a)if(a.hasOwnProperty(d)&&b.call(c||null,a[d],d,a)===!1)break}function d(b,c,d){var e,f;if(a.util.isArray(b))for(e=0,f=b.length;f>e;e++)c.call(d||null,b[e],e,b);else a.util.forEachOwnProperties(b,c,d)}function e(b,c,d){var e=[];return a.util.forEach(b,function(){e.push(c.apply(d||null,arguments))}),e}function f(b,c,d){var e,f,g,h=0;for(a.util.isArray(b)||(e=a.util.keys(b)),f=e?e.length:b.length,g=b[e?e[h++]:h++];f>h;h++)g=c.call(d||null,g,b[e?e[h]:h]);return g}function g(a){var c;try{c=Array.prototype.slice.call(a)}catch(d){c=[],b(a,function(a){c.push(a)})}return c}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.forEachOwnProperties=c,a.util.forEachArray=b,a.util.forEach=d,a.util.toArray=g,a.util.map=e,a.util.reduce=f}(window.ne),function(a){"use strict";function b(){this._events={}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var c={on:function(a,b,c){this._toggle(!0,a,b,c)},off:function(b,c,d){return a.util.isExisty(b)?void this._toggle(!1,b,c,d):void(this._events=null)},_toggle:function(b,c,d,e){var f=b?"_on":"_off",g=this[f];a.util.isObject(c)?a.util.forEachOwnProperties(c,function(a,b){g.call(this,b,a,d)},this):(c=c.split(" "),a.util.forEach(c,function(a){g.call(this,a,d,e)},this))},_on:function(b,c,d){var e=this._events=this._events||{},f=d&&d!==this&&a.util.stamp(d);if(f){var g=b+"_idx",h=b+"_len",i=e[g]=e[g]||{},j=a.util.stamp(c)+"_"+f;i[j]||(i[j]={fn:c,ctx:d},e[h]=(e[h]||0)+1)}else e[b]=e[b]||[],e[b].push({fn:c})},_off:function(b,c,d){var e=this._events,f=b+"_idx",g=b+"_len";if(e){var h,i,j=d&&d!==this&&a.util.stamp(d);j?(i=a.util.stamp(c)+"_"+j,h=e[f],h&&h[i]&&(h[i]=null,e[g]-=1)):(h=e[b],h&&a.util.forEach(h,function(b,d){return a.util.isExisty(b)&&b.fn===c?(h.splice(d,1),!0):void 0}))}},invoke:function(b){if(!this.hasListener(b))return!0;var c=Array.prototype.slice.call(arguments,1),d=this._events;if(!d)return!0;var e,f=d[b+"_idx"],g=!0;return d[b]&&(e=d[b].slice(),a.util.forEach(e,function(a){a.fn.apply(this,c)===!1&&(g=!1)},this)),a.util.forEachOwnProperties(f,function(a){a.fn.apply(a.ctx,c)===!1&&(g=!1)}),g},fire:function(){return this.invoke.apply(this,arguments),this},hasListener:function(b){var c=this._events,d=a.util.isExisty;return d(c)&&(d(c[b])||c[b+"_len"])},getListenerLength:function(b){var c,d,e=this._events,f=b+"_len",g=0;return a.util.isExisty(e)?(c=e[b],d=e[f],g+=a.util.isExisty(c)&&a.util.isArray(c)?c.length:0,g+=a.util.isExisty(d)?d:0):0},once:function(b,c,d){function e(){c.apply(d,arguments),f.off(b,e,d)}var f=this;return a.util.isObject(b)?void a.util.forEachOwnProperties(b,function(a,b){this.once(b,a,c)},this):void this.on(b,e,d)}};b.prototype=c,b.prototype.constructor=b,b.mixin=function(b){a.util.extend(b.prototype,c)},a.util.CustomEvents=b}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var b=function(b,c){var d;return c||(c=b,b=null),d=c.init||function(){},b&&a.util.inherit(d,b),c.hasOwnProperty("static")&&(a.util.extend(d,c.static),delete c.static),a.util.extend(d.prototype,c),d};a.util.defineClass=b}(window.ne),function(a){"use strict";function b(b){return a.util.forEach(b,function(a,c){b[c]=String(a)},this),b}function c(b){var c={},d=b.serializeArray();return a.util.forEach(d,function(b){var d=b.value,e=b.name;a.util.isExisty(c[e])?(c[e].push||(c[e]=[c[e]]),c[e].push(d||"")):c[e]=d||""},this),c}function d(a,b){var c;return a&&a.length&&(c=b?a.prop("elements")[b+""]:a.prop("elements")),$(c)}function e(b,c){a.util.forEachOwnProperties(c,function(a,c){f(b,c,a)},this)}function f(b,c,e){var f,g=d(b,c);g&&(a.util.isArray(e)||(e=String(e)),g=a.util.isHTMLTag(g)?[g]:g,g=a.util.toArray(g),a.util.forEach(g,function(a){f=h[a.type]?a.type:"defaultAction",h[f](a,e)},this))}function g(a){a.focus();var b=a.value.length;if(a.setSelectionRange)a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var h={radio:function(a,b){a.checked=a.value===b},checkbox:function(c,d){c.checked=a.util.isArray(d)?-1!==$.inArray(c.value,b(d)):c.value===d},"select-one":function(b,c){var d=a.util.toArray(b.options),e=-1;a.util.forEach(d,function(a,b){return a.value===c||a.text===c?(e=b,!1):void 0},this),b.selectedIndex=e},"select-multiple":function(c,d){var e=a.util.toArray(c.options);a.util.isArray(d)?(d=b(d),a.util.forEach(e,function(a){a.selected=-1!==$.inArray(a.value,d)||-1!==$.inArray(a.text,d)},this)):this["select-one"].apply(this,arguments)},defaultAction:function(a,b){a.value=b}};a.util.getFormElement=d,a.util.getFormData=c,a.util.setFormData=e,a.util.setFormElementValue=f,a.util.setCursorToEnd=g}(window.ne),function(a){"use strict";function b(a,b){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var d=c.call(arguments,2);return function(){return a.apply(b,d.length?d.concat(c.call(arguments)):arguments)}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.bind=b}(window.ne),function(a){"use strict";function b(a){this.length=0,a&&this.setObject(a)}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var c="å";b.prototype.set=function(a,b){2===arguments.length?this.setKeyValue(a,b):this.setObject(a)},b.prototype.setKeyValue=function(a,b){this.has(a)||(this.length+=1),this[this.encodeKey(a)]=b},b.prototype.setObject=function(b){var c=this;a.util.forEachOwnProperties(b,function(a,b){c.setKeyValue(b,a)})},b.prototype.encodeKey=function(a){return c+a},b.prototype.decodeKey=function(a){var b=a.split(c);return b[b.length-1]},b.prototype.get=function(a){return this[this.encodeKey(a)]},b.prototype.has=function(a){return this.hasOwnProperty(this.encodeKey(a))},b.prototype.remove=function(b){return arguments.length>1&&(b=a.util.toArray(arguments)),a.util.isArray(b)?this.removeByKeyArray(b):this.removeByKey(b)},b.prototype.removeByKey=function(a){var b=this.has(a)?this.get(a):null;return null!==b&&(delete this[this.encodeKey(a)],this.length-=1),b},b.prototype.removeByKeyArray=function(b){var c=[],d=this;return a.util.forEach(b,function(a){c.push(d.removeByKey(a))}),c},b.prototype.removeAll=function(){var a=this;this.each(function(b,c){a.remove(c)})},b.prototype.each=function(b){var d,e=this;a.util.forEachOwnProperties(this,function(a,f){return f.charAt(0)===c&&(d=b(a,e.decodeKey(f))),d===!1?d:void 0})},b.prototype.keys=function(){var a=[],b=this;return this.each(function(c,d){a.push(b.decodeKey(d))}),a},b.prototype.find=function(a){var b=[];return this.each(function(c,d){a(c,d)&&b.push(c)}),b},a.util.HashMap=b}(window.ne),function(a){"use strict";function b(){function a(){}return function(b){return a.prototype=b,new a}}function c(b,c){var d=a.util.createObject(c.prototype);d.constructor=b,b.prototype=d}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.createObject=b(),a.util.inherit=c}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={})}(window.ne),function(a){"use strict";function b(a){var b,c,d,e,f=Object.prototype.hasOwnProperty;for(d=1,e=arguments.length;e>d;d++){b=arguments[d];for(c in b)f.call(b,c)&&(a[c]=b[c])}return a}function c(a){return a.__fe_id=a.__fe_id||++e,a.__fe_id}function d(){e=0}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var e=0,f=function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c};a.util.extend=b,a.util.stamp=c,a.util._resetLastId=d,a.util.keys=Object.keys||f}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={})}(window.ne),function(a){"use strict";function b(a){var b={"&quot;":'"',"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&nbsp;":" "};return a.replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&nbsp;/g,function(a){return b[a]?b[a]:a})}function c(a){var b={'"':"quot","&":"amp","<":"lt",">":"gt","'":"#39"};return a.replace(/[<>&"']/g,function(a){return b[a]?"&"+b[a]+";":a})}function d(a){return/[<>&"']/.test(a)}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.decodeHTMLEntity=b,a.util.encodeHTMLEntity=c,a.util.hasEncodableString=d}(window.ne),function(a){"use strict";function b(b,e){if(arguments.length<2)return!d(b)&&!c(b);if(!i(b))return!1;if(e=l(e)?e.split("."):e,!h(e))return!1;e.unshift(b);var f=a.util.reduce(e,function(a,b){return a?a[b]:void 0});return!d(f)&&!c(f)}function c(a){return void 0===a}function d(a){return null===a}function e(a){return b(a)&&a!==!1}function f(a){return!e(a)}function g(a){var c=b(a)&&("[object Arguments]"===r.call(a)||"callee"in a);return c}function h(a){return"[object Array]"===r.call(a)}function i(a){return a===Object(a)}function j(a){return"[object Function]"===r.call(a)}function k(a){return"[object Number]"===r.call(a)}function l(a){return"[object String]"===r.call(a)}function m(a){return"[object Boolean]"===r.call(a)}function n(a){return"object"==typeof HTMLElement?a&&(a instanceof HTMLElement||!!a.nodeType):!(!a||!a.nodeType)}function o(a){return"object"==typeof HTMLElement?a&&a instanceof HTMLElement:!(!a||!a.nodeType||1!==a.nodeType)}function p(c){var d=!1;return b(c)?h(c)||g(c)?0===c.length:i(c)&&!j(c)?(a.util.forEachOwnProperties(c,function(){return d=!0,!1}),!d):!0:!0}function q(a){return!p(a)}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var r=Object.prototype.toString;a.util.isExisty=b,a.util.isUndefined=c,a.util.isNull=d,a.util.isTruthy=e,a.util.isFalsy=f,a.util.isArguments=g,a.util.isArray=Array.isArray||h,a.util.isObject=i,a.util.isFunction=j,a.util.isNumber=k,a.util.isString=l,a.util.isBoolean=m,a.util.isHTMLNode=n,a.util.isHTMLTag=o,a.util.isEmpty=p,a.util.isNotEmpty=q}(window.ne),function(a){"use strict";function b(b){if(!a.util.isExisty(b))return void 0;for(var c,d=b.split("."),f=0,g=d.length,h=e;g>f&&(c=d[f],"undefined"!=typeof h);f++)h=h[c];return h}function c(b,d){if("string"!=typeof b)a.util.forEach(b,function(a,b){c(b,a)});else if("undefined"!=typeof d)for(var f,g=b.split("."),h=0,i=g.length,j=e;i>h;h++){if(f=g[h],h===i-1)return j[f]=d;"undefined"==typeof j[f]&&(j[f]={}),j=j[f]}}function d(b){if(a.util.isExisty(b)){if(!a.util.isObject(b)||a.util.isFunction(b)||a.util.isArray(b))throw new Error("variable: 전역변수 공간은 object 형태의 데이터로만 설정이 가능합니다.");e=b}else e={}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var e={};a.util.variable={get:b,set:c,reset:d}}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={})}(window.ne),ne=window.ne||{},ne.Component=ne.Component||{};var Base=ne.util.defineClass({init:function(a){a&&a.grid&&this.setOwnProperties({grid:a.grid})},getUniqueKey:function(){var a=String(parseInt(1e10*Math.random(),10)),b=(new Date).getTime()+a;return b},setOwnProperties:function(a){return ne.util.forEach(a,function(a,b){this[b]=a},this),this},error:function(a){var b=function(){this.message=a};return b.prototype=new Error,new b}});ne.util.CustomEvents.mixin(Base),Base.View=ne.util.defineClass(Base,{tagName:"div",className:"",eventHandler:{},style:"",init:function(a){Base.prototype.init.apply(this,arguments);var b={},c=a&&a.$el||$("<"+this.tagName+">");c.addClass(this.className),ne.util.forEach(this.eventHandler,function(a,c){b[c]=$.proxy(this[a],this)},this),this._attachHandler(c),a&&a.model&&this.setOwnProperties({model:a.model}),this.setOwnProperties({_viewList:[],_eventHandler:b,$el:c,el:c[0]}),this._initializeStyle()},_initializeStyle:function(){this.style&&this.$el.attr("style",this.style)},_dispatchHandler:function(a,b){a=a||this.$el,a.length&&ne.util.forEach(this._eventHandler,function(c,d){var e=d.split(" "),f=e[0],g=e[1]||"";g&&(a=a.find(g)),a.off(f),b&&a.on(f,c)},this)},_attachHandler:function(a){this._dispatchHandler(a,!0)},_detachHandler:function(a){this._dispatchHandler(a)},createView:function(a,b){var c=new a(b);return this.hasOwnProperty("_viewList")||this.setOwnProperties({_viewList:[]}),this._viewList.push(c),c},destroyChildren:function(){if(ne.util.isArray(this._viewList))for(;0!==this._viewList.length;)this._viewList.pop().destroy()},destroy:function(){this.destroyChildren(),this._detachHandler(this.$el),this.$el.empty().remove()}});var Util={template:function(a,b){a.replace(/<%=[^%]+%>/g,"");var c=a.replace(/<%=([^%]+)%>/g,function(a,c){return ne.util.isUndefined(b[c])?"":b[c].toString()});return c},getHeight:function(a,b,c){return c=ne.util.isUndefined(c)?1:c,0===a?a:a*(b+c)+c},getDisplayRowCount:function(a,b){return Math.ceil((a-1)/(b+1))},getRowHeight:function(a,b){return 0===a?0:Math.floor((b-1)/a)-1},stripTags:function(a){var b;return a=a.replace(/[\n\r\t]/g,""),ne.util.hasEncodableString(a)&&(/<img/i.test(a)?(b=a.match(/<img[^>]*\ssrc=[\"']?([^>\"']+)[\"']?[^>]*>/i),a=b?b[1]:""):a=a.replace(/<button.*?<\/button>/gi,""),a=$.trim(ne.util.decodeHTMLEntity(a.replace(/<\/?(?:h[1-5]|[a-z]+(?:\:[a-z]+)?)[^>]*>/gi,"")))),a}},Collection=ne.util.defineClass(Base,{init:function(){Base.prototype.init.apply(this,arguments),this.setOwnProperties({maxLength:0,list:[],map:{},length:0,idx:0,worker:new Worker}),this.on("change",this._onChange,this)},lock:function(){this.worker.lock()},unlock:function(){this.worker.unlock()},_onChange:function(){this.length=this.list.length},set:function(){this.worker.enqueue(this._set,arguments,this)},_set:function(a){this.list=this._getFormattedList(a),this.maxLength>0&&this.list.length>this.maxLength&&(this._removeMap(0,this.list.length-this.maxLength),this.list=this.list.slice(this.list.length-this.maxLength,this.list.length)),this.invoke("change",{type:"set",list:a})},_removeMap:function(a,b){var c,d;for(c=a;b>c;c++)d=this.list[c].id,this.map[d]=void 0,delete this.map[d]},_getFormattedList:function(a){var b,c,d=this.grid.option("idAttribute"),e=[],f=!!d;return ne.util.forEachArray(a,function(a){c=f?a[d]:this.idx++,b={id:c,data:a},e.push(b),this.map[b.id]=b},this),e},at:function(a){return this.list[a]},get:function(a){return this.map[a]},indexOf:function(a){var b=-1;return a&&void 0!==a.id?(ne.util.forEachArray(this.list,function(c,d){return c&&c.id.toString()===a.id.toString()?(b=d,!1):void 0},this),b):-1},append:function(){this.worker.enqueue(this._append,arguments,this)},_append:function(a){a=this._getFormattedList(a),this.list=this.list.concat(a),this.maxLength>0&&this.list.length>this.maxLength&&(this._removeMap(0,this.list.length-this.maxLength),this.list=this.list.slice(this.list.length-this.maxLength,this.list.length)),this.invoke("change",{type:"append",list:this.list,appended:a})},prepend:function(){this.worker.enqueue(this._prepend,arguments,this)},_prepend:function(a){a=this._getFormattedList(a),this.list=a.concat(this.list),this.maxLength>0&&this.list.length>this.maxLength&&(this._removeMap(this.maxLength,this.list.length),this.list=this.list.slice(0,this.maxLength)),this.invoke("change",{type:"prepend",list:this.list,prepended:a})},remove:function(){this.worker.enqueue(this._remove,arguments,this)},_remove:function(a){var b=this.indexOf(this.get(a));this.map[a]=void 0,delete this.map[a],this.list.splice(b,1),this.invoke("change",{type:"remove",list:this.list})},clear:function(){this.worker.enqueue(this._clear,arguments,this)},_clear:function(){this.list=[],this.map={},this.invoke("change",{type:"clear",list:this.list,idx:0})}}),Worker=ne.util.defineClass(Base,{init:function(){Base.prototype.init.apply(this,arguments),this.setOwnProperties({locked:!1,queue:[]})},lock:function(){this.locked=!0},unlock:function(a){a||this.runQueue(),this.locked=!1},enqueue:function(a,b,c){this.locked?this.queue.push({job:a,args:b,context:c}):a.apply(c,b)},dequeue:function(){return this.queue.shift()},runQueue:function(){for(var a=this.dequeue();a;)a.job.apply(a.context,a.args),a=this.dequeue()}}),Focus=ne.util.defineClass(Base,{init:function(a){Base.prototype.init.apply(this,arguments),this.setOwnProperties({selectMap:{},isMultiple:a&&a.isMultiple||!1})},getSelectList:function(){return ne.util.keys(this.selectMap)},select:function(a){this.isMultiple||ne.util.forEach(this.selectMap,function(a,b){this.unselect(b)},this),this.selectMap[a]=!0,this.fire("select",a,this.selectMap)},unselect:function(a){ne.util.isUndefined(a)?ne.util.forEach(this.selectMap,function(a,b){this.unselect(b)},this):(this.selectMap[a]=null,delete this.selectMap[a],this.fire("unselect",a,this.selectMap))}}),Model=ne.util.defineClass(Base,{init:function(){Base.prototype.init.apply(this,arguments),this._initializeVariables(),this._setHeight(),this.collection.on({change:this._onCollectionChange},this),this.on({change:this._onChange},this),this._calculateColumnWidthList()},_initializeVariables:function(){this.setOwnProperties({collection:new Collection({grid:this.grid}),offsetTop:0,offsetLeft:0,width:0,height:0,headerHeight:this.grid.option("headerHeight"),containerHeight:0,containerWidth:0,stopChangeEvent:!1,freeze:!1,rowHeight:this.grid.option("rowHeight")||0,scrollTop:0,scrollLeft:0,maxScrollTop:0,startIdx:0,endIdx:0,top:0,list:[],hiddenLineCount:10,criticalPoint:3})},_resetVariables:function(){this.set({stopChangeEvent:!1,freeze:!1,headerHeight:this.grid.option("headerHeight"),rowHeight:this.grid.option("rowHeight")||0,scrollTop:0,scrollLeft:0,maxScrollTop:0,startIdx:0,endIdx:0,top:0,list:[]})},_onCollectionChange:function(a){var b=a.type;switch(this.stopChangeEvent=!0,b){case"clear":this._resetVariables(),this._refresh();break;case"prepend":this._doFreeze(a.prepended),this._refresh();break;case"set":this._refresh();break;case"append":this._refresh();break;case"remove":this._refresh()}this.stopChangeEvent=!1,this._fireChangeEvents({top:this.top,list:this.list,scrollTop:this.scrollTop})},_fireChangeEvents:function(a){ne.util.forEach(a,function(a,b){this.invoke("change",{key:b,value:a})},this)},_onChange:function(a){var b=a.key,c=a.value;switch(b){case"scrollTop":this._onScrollTopChange(c);break;case"scrollLeft":this._onScrollLeftChange(c);break;case"rowHeight":this.collection.maxLength=this._getMaxCollectionLength();break;case"containerHeight":this.collection.maxLength=this._getMaxCollectionLength();break;case"containerWidth":this._calculateColumnWidthList()}},_onScrollLeftChange:function(a){0>a&&this.set("scrollLeft",0)},_onScrollTopChange:function(a){this.maxScrollTop<a?this.set("scrollTop",this.maxScrollTop,{silent:!0}):0>a?this.set("scrollTop",0,{silent:!0}):this._isRenderable()&&this._refresh()},_getMaxCollectionLength:function(){var a=this.grid.option("border");return ne.util.browser.msie?Math.floor(this.grid.ieMaxHeight/(this.rowHeight+a)):0},getMaxScrollTop:function(){var a=this.grid.option("border"),b=Util.getHeight(this.collection.length,this.rowHeight,a)-this.containerHeight;return this.grid.option("scrollX")&&(b+=this.grid.scrollBarSize),Math.max(b,0)},set:function(a,b,c){ne.util.isObject(a)?ne.util.forEach(a,function(a,c){this.set(c,a,b)},this):this[a]!=b&&(this[a]=b,c&&c.silent||this.stopChangeEvent||this.invoke("change",{key:a,value:b}))},_setHeight:function(){var a;a=ne.util.isExisty(this.grid.option("height"))?this.grid.option("height"):Util.getHeight(this.grid.option("displayCount"),this.grid.option("rowHeight"),this.grid.option("border")),this.set("height",a)},_refresh:function(){var a=this._getRenderingData(),b=this.collection.list.slice(a.startIdx,a.endIdx);this.set({startIdx:a.startIdx,endIdx:a.endIdx,list:b,top:a.top}),this.invoke("refresh")},_calculateColumnWidthList:function(){var a,b=this.grid.option("columnModelList"),c=[],d=this.grid.option("defaultColumnWidth"),e=0,f=this.containerWidth-this.grid.scrollBarSize;ne.util.forEachArray(b,function(a){var b=ne.util.isUndefined(a.width)?d:a.width;ne.util.isString(b)&&b.indexOf("%")&&(b=b.replace("%",""),b=Math.floor(f*(b/100))),c.push(b),e+=b},this),a=f-e,a>0?c[c.length-1]+=a:f+=Math.abs(a),this.set({width:f,columnWidthList:c})},_getDataHeight:function(a){var b=this.grid.option("border");return Util.getHeight(a.length,this.rowHeight,b)},_doFreeze:function(a){if(this.freeze||this.grid.option("freeze")&&0!==this.scrollTop){var b=this._getDataHeight(a);this.set("maxScrollTop",this.getMaxScrollTop()),this.set("scrollTop",this.scrollTop+b)}},_getRenderingData:function(){var a,b=this.grid.option("border"),c=this.scrollTop,d=this.rowHeight,e=this.grid.option("displayCount"),f=Math.max(0,Math.ceil(c/(d+b))-this.hiddenLineCount),g=Math.min(this.collection.length,Math.floor(f+this.hiddenLineCount+e+this.hiddenLineCount));return a=0===f?0:Util.getHeight(f,d,b)-b,{top:a,startIdx:f,endIdx:g}},_isRenderable:function(){var a=this.grid.option("border"),b=this.scrollTop,c=this.rowHeight,d=this.height,e=(this.grid.option("displayCount"),this.collection.length),f=Math.max(0,Math.ceil(b/(c+a))),g=Math.min(e-1,Math.floor((b+d)/(c+a))),h=Math.max(0,this.startIdx),i=Math.min(e,this.endIdx);return 0!==h&&h+this.criticalPoint>f?!0:i!==e&&i-this.criticalPoint<g?!0:!1}}),Body=ne.util.defineClass(Base.View,{eventHandler:{mousedown:"_onMouseDown",click:"_onClick"},className:"infinite_body",style:"position: absolute; top: 0; white-space: nowrap;",_template:{table:'<table width="100%" border="0" cellpadding="0" cellspacing="<%=border%>" bgcolor="<%=color%>" class="<%=className%>" ><colgroup><%=col%></colgroup><tbody><%=tbody%></tbody>',tr:'<tr key="<%=key%>" style="height:<%=height%>px;background:<%=color%>;" class="<%=className%>" ><%=content%></tr>',td:'<td columnname="<%=columnName%>" style="text-align:<%=align%>;overflow:hidden;" class="<%=className%>" <%=attributes%>><%=content%></td>'},init:function(a){Base.View.prototype.init.apply(this,arguments),this.grid.option("useSelection")&&this.setOwnProperties({selection:a.selection}),this.grid.focusModel.on("select",this.select,this),this.grid.focusModel.on("unselect",this.unselect,this),this.model.on({change:this._onModelChange,refresh:this._onRefresh},this),this.grid.view.container.on({scroll:this._onScroll},this)},select:function(a){var b=this.$el.find('tr[key="'+a+'"]');b.length&&b.css("background","").addClass("selected")},unselect:function(a){var b=this.$el.find('tr[key="'+a+'"]'),c=this.grid.option("color");b.length&&b.removeClass("selected").css("background",c.td)},_onScroll:function(){this.selection&&this.selection.draw()},_onClick:function(a){var b=$(a.target),c=b.closest("td").attr("columnname"),d=b.closest("tr").attr("key"),e={$target:b,rowKey:d,columnName:c};this.fire("click",e)},_onMouseDown:function(a){var b=$(a.target),c=b.closest("tr").attr("key"),d=this.selection;this.grid.focusModel.select(c),d&&(d.attachMouseEvent(a),a.shiftKey?(d.hasSelection()||d.startSelection(),d.updateSelection()):d.stopSelection())},_onModelChange:function(a){var b=a.key,c=a.value;"top"===b?this.$el.css("top",c+"px"):"width"===b?this._setContainerWidth(c):"columnWidthList"===b&&this._changeColumnWidth(c)},_changeColumnWidth:function(a){var b=this.$el.find("colgroup").find("col");ne.util.forEachArray(a,function(a,c){b.eq(c).css("width",a+"px")},this)},_onRefresh:function(){this.render()},_getColGroupMarkup:function(a){var b="";return ne.util.forEachArray(a,function(a){b+='<col style="width:'+a+'px"></col>'},this),b},_getTbodyMarkup:function(){var a=this.model.list,b=this.grid.option("columnModelList"),c=this.grid.option("color"),d=[],e=this.grid.option("className");return ne.util.forEachArray(a,function(a){var f=[],g=this.model.rowHeight,h=a.data._colSpanBy,i=b.length,j=ne.util.isExisty(h)?'colspan="'+i+'"':"";ne.util.forEachArray(b,function(b){var c,d,g=b.columnName;ne.util.isExisty(h)&&h!==g||(d=ne.util.isFunction(b.formatter)?b.formatter(a.data[g],a.data):a.data[g],c=Util.template(this._template.td,{className:e.td,columnName:g,align:b.align,content:d,attributes:j}),f.push(c))},this),d.push(Util.template(this._template.tr,{className:e.tr,color:c.td,height:g,key:a.id,content:f.join("")}))},this),d.join("")},render:function(){this._detachHandler(),this.destroyChildren();var a=this.model.columnWidthList,b=this.grid.option("color"),c=this.grid.option("border"),d=this.grid.focusModel.getSelectList(),e=this.grid.option("className");return this.$el.html(Util.template(this._template.table,{className:e.table,border:c,color:c?b.border:"",col:this._getColGroupMarkup(a),tbody:this._getTbodyMarkup()})),this._setContainerWidth(Math.ceil(this.model.width)),ne.util.forEachArray(d,function(a){this.select(a)},this),this.selection&&this.selection.draw(),this._attachHandler(),this},_setContainerWidth:function(a){0===a?a="100%":a+="px",this.$el.css("width",a)}}),Container=ne.util.defineClass(Base.View,{className:"infinite_container",eventHandler:{scroll:"_onScroll"},style:"position: relative;",init:function(){Base.View.prototype.init.apply(this,arguments),this.model.on({change:this._onModelChange},this),this._initializeCss()},_initializeCss:function(){var a=this.grid.option("color").border,b=this.grid.option("border");this.$el.css({"overflow-x":this.grid.option("scrollX")?"scroll":"hidden","overflow-y":this.grid.option("scrollY")?"scroll":"hidden",height:this.grid.option("scrollX")?this.model.height+this.grid.scrollBarSize:this.model.height}),0===b&&this.$el.css("border","solid 1px "+a)},_onScroll:function(a){var b=Math.abs(this.model.scrollTop-a.target.scrollTop);10>b&&b>0&&(this.model.scrollTop>a.target.scrollTop?a.target.scrollTop-=80:a.target.scrollTop+=80),this.model.set({scrollTop:a.target.scrollTop,scrollLeft:a.target.scrollLeft}),this.invoke("scroll",a)},_onModelChange:function(a){var b=a.key,c=a.value;"scrollTop"===b?this.el.scrollTop=c:"scrollLeft"===b&&(this.el.scrollLeft=c,this.el.scrollLeft!==c&&this.model.set("scrollLeft",this.el.scrollLeft))},render:function(){return this._detachHandler(),this.destroyChildren(),this.selection=this.createView(Selection,{grid:this.grid,model:this.model}),this.body=this.createView(Body,{grid:this.grid,selection:this.selection,model:this.model}),this.$el.empty().append(this.body.render().el).append(this.selection.render().el),this._attachHandler(),this}}),Header=ne.util.defineClass(Base.View,{eventHandler:{scroll:"_onScroll"},className:"infinite_header_container",style:"overflow:hidden",init:function(){Base.View.prototype.init.apply(this,arguments),this.model.on("change",this._onModelChange,this)},_template:{table:'<div class="header"><table width="100%" border="0" cellpadding="0" cellspacing="<%=border%>"><colgroup><%=col%></colgroup><tbody><%=tbody%></tbody></div>'},_onModelChange:function(a){var b=a.key,c=a.value;"width"===b?this._setContainerWidth(c):"scrollLeft"===b?this.$el[0].scrollLeft=c:"columnWidthList"===b&&this._changeColumnWidth(c)},_onScroll:function(a){this.model.set({scrollLeft:a.target.scrollLeft})},_changeColumnWidth:function(a){var b=this.$el.find("colgroup").find("col");ne.util.forEachArray(a,function(a,c){b.eq(c).width(a)},this)},render:function(){this._detachHandler(),this.destroyChildren();var a,b=this.grid.option("columnModelList"),c=this.grid.option("border"),d="",e=this.model.headerHeight,f="",g=this.grid.option("color");return ne.util.forEachArray(b,function(){f+="<col></col>"},this),d+='<tr style="height:'+e+'px">',ne.util.forEachArray(b,function(a){d+='<th columnname="'+a.columnName+'">'+a.title+"</th>"}),d+="</tr>",a=Util.template(this._template.table,{border:c,col:f,tbody:d}),this.$el.html(a),this._setContainerWidth(this.model.width),this.$el.find("table").css("background",g.border),this.$el.find("th").css("background",g.th),0===c&&(this.$el.css("border","solid 1px "+g.border),this.$el.css("border-bottom","0px")),this._attachHandler(),this},_setContainerWidth:function(a){0===a?a="100%":a+="px",this.$el.find(".header:first").css("width",a)}}),Keyboard=ne.util.defineClass(Base.View,{keyMap:{PAGE_UP:33,PAGE_DOWN:34,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,HOME:36,END:35,CHAR_A:65,CHAR_C:67,CTRL:17,META:91,SHIFT:16},eventHandler:{keydown:"_onKeyDown",keyup:"_onKeyUp",blur:"_onBlur",focus:"_onFocus"},tagName:"textarea",style:"position: absolute; width: 0; height: 0; top:0, left: -9999px;",init:function(){Base.View.prototype.init.apply(this,arguments)},_onFocus:function(){this.grid.getSelectionInstance().show()},_onBlur:function(){this.model.collection.unlock(),this.grid.blur()},_onKeyUp:function(){this.model.collection.unlock()},_onKeyDown:function(a){var b=!0,c=a.which?a.which:a.keyCode;switch(this.model.collection.lock(),c){case this.keyMap.SHIFT:break;case this.keyMap.CTRL:break;case this.keyMap.META:break;case this.keyMap.UP_ARROW:this.scrollVertical(-this.grid.scrollingScale);break;case this.keyMap.DOWN_ARROW:this.scrollVertical(this.grid.scrollingScale);break;case this.keyMap.LEFT_ARROW:this.scrollHorizontal(-this.grid.scrollingScale);break;case this.keyMap.RIGHT_ARROW:this.scrollHorizontal(this.grid.scrollingScale);break;case this.keyMap.PAGE_UP:this.scrollVertical(-this.grid.scrollingScalePerPage,!0);break;case this.keyMap.PAGE_DOWN:this.scrollVertical(this.grid.scrollingScalePerPage,!0);
break;case this.keyMap.HOME:this.model.set("scrollTop",0);break;case this.keyMap.END:this.model.set("scrollTop",this.model.maxScrollTop);break;case this.keyMap.CHAR_A:(a.ctrlKey||a.metaKey)&&(a.preventDefault(),this.grid.getSelectionInstance().selectAll());break;case this.keyMap.CHAR_C:(a.ctrlKey||a.metaKey)&&this._keyDownForCopy();break;default:b=!1}b&&!this.grid.option("keyEventBubble")&&a.stopPropagation()},_keyDownForCopy:function(){var a=this.grid.getSelectionInstance().getSelectionData().join("\n");window.clipboardData?window.clipboardData.setData("Text",a)?this.$el.select():this.$el.val("").select():this.$el.val(a).select()},scrollVertical:function(a,b){a=b?Math.floor(this.model.height*(a/100)):a;var c=Math.max(0,this.model.scrollTop+a);this.model.set("scrollTop",c)},scrollHorizontal:function(a){var b=Math.max(0,this.model.scrollLeft+a);this.model.set("scrollLeft",b)},render:function(){return this._detachHandler(),this._attachHandler(),this}}),Selection=ne.util.defineClass(Base.View,{eventHandler:{mousedown:"_onMouseDown"},className:"infinite_selection_layer",style:"display:none;position:absolute;top:0;left:1px;width:0;height:0;border:dotted 1px red;background:orange;opacity:0.2;filter:alpha(opacity=10)",init:function(){Base.View.prototype.init.apply(this,arguments),this.grid.view.keyboard.on({blur:this.stopSelection},this),this.model.on({change:this._onModelChange},this),this.setOwnProperties({rangeKey:[-1,-1],isShown:!1}),this.setOwnProperties({selectionHandler:{mousemove:$.proxy(this._onMouseMove,this),mouseup:$.proxy(this._onMouseUp,this),selectstart:$.proxy(this._onSelectStart,this)},timeoutForUpdateSelection:0,startPageX:0,startPageY:0,mousePos:{pageX:0,pageY:0}})},attachMouseEvent:function(a){this.grid.option("useSelection")&&(this.setOwnProperties({startPageX:a.pageX,startPageY:a.pageY}),this._setMousePos(a),$(document).on("mousemove",this.selectionHandler.mousemove),$(document).on("mouseup",this.selectionHandler.mouseup),$(document).on("selectstart",this.selectionHandler.selectstart))},detachMouseEvent:function(){$(document).off("mousemove",this.selectionHandler.mousemove),$(document).off("mouseup",this.selectionHandler.mouseup),$(document).off("selectstart",this.selectionHandler.selectstart)},_onMouseDown:function(a){var b=a.pageX,c=a.pageY,d=this.getKey(b,c);this.attachMouseEvent(a),this.grid.focusModel.select(d),a.shiftKey?(this.hasSelection()||this.startSelection(d),this.updateSelection(d)):this.stopSelection()},_onMouseMove:function(a){this._setMousePos(a),this.hasSelection()?(clearTimeout(this.timeoutForUpdateSelection),this.timeoutForUpdateSelection=setTimeout($.proxy(this._scrollOnSelection,this),0),this.updateSelection()):this._getDistance(a)>10&&this.startSelection(this.getKey(this.startPageX,this.startPageY))},_onMouseUp:function(){this.detachMouseEvent()},_onSelectStart:function(a){return a.preventDefault(),!1},_scrollOnSelection:function(){if(this.hasSelection()){var a=this.overflowStatus(this.mousePos.pageX,this.mousePos.pageY);a.y>0?this.model.set("scrollTop",this.model.scrollTop+this.grid.scrollingScale):a.y<0&&this.model.set("scrollTop",this.model.scrollTop-this.grid.scrollingScale),a.x>0?this.model.set("scrollLeft",this.model.scrollLeft+this.grid.scrollingScale):a.x<0&&this.model.set("scrollLeft",this.model.scrollLeft-this.grid.scrollingScale)}},_getDistance:function(a){var b=a.pageX,c=a.pageY,d=Math.abs(this.startPageX-b),e=Math.abs(this.startPageY-c);return Math.round(Math.sqrt(Math.pow(d,2)+Math.pow(e,2)))},_setMousePos:function(a){this.mousePos.pageX=a.pageX,this.mousePos.pageY=a.pageY},_onModelChange:function(a){var b=a.key,c=a.value;"headerHeight"===b||"top"===b?this.draw():"width"===b&&this.$el.width(c-3)},getSelectionRange:function(){return this.rangeKey},getSelectionRangeIndex:function(){var a=this.model.collection,b=[a.indexOf(a.get(this.rangeKey[0])),a.indexOf(a.get(this.rangeKey[1]))],c=Math.min.apply(Math,b),d=Math.max.apply(Math,b);return[c,d]},hasSelection:function(){return!(-1===this.rangeKey[0])},getSelectionLength:function(){var a=this.getSelectionRangeIndex();return a[1]+1-a[0]},startSelection:function(a){this.grid.option("useSelection")&&(a=ne.util.isUndefined(a)?this.getKey(this.mousePos.pageX,this.mousePos.pageY):a,-1!==a&&(this.rangeKey[0]=a,this.updateSelection(a)))},updateSelection:function(a){this.grid.option("useSelection")&&(a=ne.util.isUndefined(a)?this.getKey(this.mousePos.pageX,this.mousePos.pageY):a,-1!==a&&(this.rangeKey[1]=a,this.show()))},getSelectionData:function(){var a=this.getSelectionRangeIndex(),b=this.model.collection.list.slice(a[0],a[1]+1),c=this.grid.option("columnModelList"),d=[];return ne.util.forEachArray(b,function(a){var b=[];ne.util.forEachArray(c,function(c){var d,e=c.columnName,f=a.data;d=ne.util.isFunction(c.formatter)?c.formatter(f[e],f):f[e],b.push(Util.stripTags(d))}),d.push(b.join("	"))}),d},selectAll:function(){var a=this.model.collection;this.rangeKey=[a.at(0).id,a.at(a.length-1).id],this.draw()},stopSelection:function(){this.rangeKey=[-1,-1],this.draw()},show:function(){this.isShown=!0,this.draw()},hide:function(){this.isShown=!1,this.draw()},overflowStatus:function(a,b){var c=b-this.model.offsetTop-this.model.headerHeight,d=a-this.model.offsetLeft,e={x:0,y:0};return c>this.model.height+this.model.headerHeight?e.y=1:0>c&&(e.y=-1),d>this.model.containerWidth?e.x=1:0>d&&(e.x=-1),e},getKey:function(a,b){var c,d=this.model,e=d.scrollTop,f=d.rowHeight,g=d.offsetTop,h=d.height,i=this.grid.option("border"),j=d.headerHeight,k=b-g-j,l=e+k,m=this.overflowStatus(a,b);return m.y>0?l=e+h-1:m.y<0&&(l=e+1),c=Math.min(Math.max(0,Math.floor(l/(f+i))),d.collection.length-1),d.collection.at(c)&&d.collection.at(c).id},draw:function(){if(this.isShown&&-1!==this.rangeKey[0]&&-1!==this.rangeKey[1]){var a,b,c,d=this.model.collection,e=this.grid.option("border"),f=d.indexOf(d.get(this.rangeKey[0])),g=d.indexOf(d.get(this.rangeKey[1])),h=(d.length,Math.min(f,g)),i=Math.max(f,g),j=Util.getHeight(h,this.model.rowHeight,e)-e,k=Util.getHeight(i-h+1,this.model.rowHeight,e),l=this.model.width-3,m="block";a=Math.max(this.model.scrollTop-10,j)-1,b=a-j,c=Math.min(this.model.height+10,k-b)-2,0>=c&&(m="none"),this.$el.css({width:l+"px",top:a+"px",height:c+"px",display:m})}else this.$el.css({display:"none"}),this.isShown&&this.grid.view.keyboard.$el.val("")},render:function(){var a=this.grid.option("color"),b=this.grid.option("opacity");return this._detachHandler(),this.$el.css({width:"100%",background:a.selection,opacity:b}),this.draw(),this._attachHandler(),this},destroy:function(){this.detachMouseEvent(),this.destroyChildren(),this._detachHandler(this.$el),this.$el.empty().remove()}}),Spacer=ne.util.defineClass(Base.View,{eventHandler:{},className:"infinite_spacer",style:"display: block;	position: absolute;	top: 0;	right: 0; width: 16px;",init:function(){Base.View.prototype.init.apply(this,arguments)},render:function(){var a=this.grid,b=a.option("color"),c=a.option("headerHeight"),d=a.option("border"),e=d?0:1,f=d?0:1,g=17-d,h={top:e+"px",right:f+"px",background:b.th,height:c+"px",width:g+"px",border:"solid "+d+"px "+b.border};return this._detachHandler(),this.destroyChildren(),this.$el.css(h),this._attachHandler(),this}}),VirtualScrollBar=ne.util.defineClass(Base.View,{className:"infinite_virtial_scrollbar",eventHandler:{scroll:"_onScroll"},style:"overflow-y: scroll; overflow-x: hidden; position: absolute; top: 0; right: 0; display: block;",init:function(){Base.View.prototype.init.apply(this,arguments),this.model.on({change:this._onModelChange},this),this.setOwnProperties({timeoutIdForLock:0,isScrollHandlerFocused:!1})},_onMouseDown:function(){this.model.collection.lock(),this.grid.updateLayoutData(),this.isScrollHandlerFocused=!0,this._updateUnlockTimeout()},_updateUnlockTimeout:function(){this.isScrollHandlerFocused&&(clearTimeout(this.timeoutIdForLock),this.model.collection.lock(),this.timeoutIdForLock=setTimeout($.proxy(function(){this.isScrollHandlerFocused=!1,this.model.collection.unlock()},this),1e3))},_onScroll:function(a){this.model.set("scrollTop",$(a.target).scrollTop()),this._updateUnlockTimeout(),this.isScrollHandlerFocused=!0},_onModelChange:function(a){var b=a.key,c=a.value;"scrollTop"===b?(this.isScrollHandlerFocused=!1,this._onScrollTopChange(c)):"headerHeight"===b?this.$el.css("top",c+"px"):this._setContentHeight()},_onScrollTopChange:function(a){this.el.scrollTop=a},_getMaxScrollTop:function(){return this.$el.find(".infinite_content").height()-this.$el.innerHeight()},render:function(){this._detachHandler();var a,b=0===this.grid.option("border")?1:0,c=this.createView(VirtualScrollBar.Content,{grid:this.grid}),d=this.grid.option("border");return a=this.grid.option("hasHeader")?this.grid.option("headerHeight")+(2*d||2):1,this.$el.css({height:this.grid.option("scrollX")?this.model.height+this.grid.scrollBarSize:this.model.height,top:a,right:b}),this.$el.empty(),this.$el.html(c.render().el),this._setContentHeight(),this._attachHandler(),this},_setContentHeight:function(){var a,b=this.grid.option("border"),c=this.grid.option("rowHeight"),d=this.model.collection.length,e=Util.getHeight(d,c,b);this.grid.option("scrollX")&&(e+=this.grid.scrollBarSize),this.$el.find(".infinite_content").height(e),a=this.model.getMaxScrollTop(),this.model.set("maxScrollTop",a)},_getContentHeight:function(){return this.$el.find(".infinite_content").height()}});VirtualScrollBar.Content=ne.util.defineClass(Base.View,{className:"infinite_content",style:"width: 1px; display: block; background: transparent;",init:function(){Base.View.prototype.init.apply(this,arguments)},render:function(){return this}}),ne.Component.SimpleGrid=ne.util.defineClass(Base.View,{scrollBarSize:17,scrollingScale:40,scrollingScalePerPage:90,ieMaxHeight:1533917,className:"simple_grid",eventHandler:{mousedown:"_onMouseDown",focus:"_onFocus"},init:function(a){Base.View.prototype.init.apply(this,arguments);var b=this.getUniqueKey(),c={rowHeight:20,displayCount:10,headerHeight:30,scrollX:!0,scrollY:!0,freeze:!0,keyEventBubble:!1,idAttribute:null,columnModelList:[],defaultColumnWidth:50,useSelection:!0,hasHeader:!0,className:{table:"",tr:"",td:""},color:{border:"#EFEFEF",th:"#F8F8F8",td:"#FFFFFF",selection:"orange"},border:1,opacity:"0.2"};return this.__instance[b]=this,a=$.extend(!0,c,a),this.setOwnProperties({id:b,model:null,focusModel:null,view:{header:null,spacer:null,container:null,virtualScroll:null,keyboard:null},options:a,timeoutIdForBlur:0}),this.option("hasHeader")||this.option("headerHeight",0),this._initializeModel(),this._initializeView(),this.render(),this._initializeCustomEvent(),this},_initializeCustomEvent:function(){this.view.container.body.on("click",function(a){return this.invoke("click",a)},this)},focus:function(){this.view.keyboard.$el.focus().select()},blur:function(){this.view.container.selection.hide()},_initializeModel:function(){this.model=new Model({grid:this}),this.focusModel=new Focus({grid:this})},_initializeView:function(){this.view.container=this.createView(Container,{grid:this,model:this.model}),this.view.keyboard=this.createView(Keyboard,{grid:this,model:this.model}),this.option("hasHeader")&&(this.view.header=this.createView(Header,{grid:this,model:this.model}),this.view.spacer=this.createView(Spacer,{grid:this,model:this.model}))},_onMouseDown:function(){$(document).on("mouseup",$.proxy(this._onMouseUp,this)),this.model.collection.lock(),this.updateLayoutData(),clearTimeout(this.timeoutIdForBlur),this.timeoutIdForBlur=setTimeout($.proxy(function(){this.focus()},this),0)},_onMouseUp:function(){this.model.collection.unlock(),$(document).off("mouseup",$.proxy(this._onMouseUp,this))},getSelectionInstance:function(){return this.view.container.selection},setList:function(a){return this.clear(),this.model.collection.set(a),this},remove:function(a){return this.model.collection.remove(a),this},append:function(a){return this.model.collection.append(a),this},prepend:function(a){return this.model.collection.prepend(a),this},clear:function(){return this.model.collection.clear(),this},getList:function(){return this.model.collection.list},render:function(){return this.destroyChildren(),this._detachHandler(),this.$el.attr({instanceId:this.id}).css({position:"relative"}),this.$el.empty(),this.option("hasHeader")&&this.$el.append(this.view.header.render().el).append(this.view.spacer.render().el),this.$el.append(this.view.container.render().el).append(this.view.keyboard.render().el),this.option("scrollY")&&(this.view.virtualScroll=this.createView(VirtualScrollBar,{grid:this,model:this.model}),this.$el.append(this.view.virtualScroll.render().el)),this.updateLayoutData(),this._attachHandler(),this},updateLayoutData:function(){var a=this.$el.offset();this.model.set({offsetTop:a.top,offsetLeft:a.left,containerWidth:this.view.container.$el.width(),containerHeight:this.view.container.$el.height()})},option:function(a,b){return void 0===b?this.options[a]:(this.options[a]=b,this)}}),ne.Component.SimpleGrid.prototype.__instance={},ne.Component.SimpleGrid.getInstanceById=function(a){return this.__instance[a]}}();